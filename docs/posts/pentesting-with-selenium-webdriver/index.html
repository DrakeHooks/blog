<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="stylesheet" type="text/css" href="../../css/style.css">
    <link rel="icon" type="image/x-icon" href="../../images/favicon.jpg">

    <title>Pentesting with Selenium WebDriver</title>
</head>
<body>
    
    <div id="nav-container" class="container">
        <nav id="nav" class="nav justify-content-center">
            <a href="../../posts/" class="nav-link">posts</a>
            <a href="../../photo/" class="nav-link">photo</a>
                
                <a href="https://github.com/DrakeHooks" target="_blank" class="nav-link github-link">
                    <img src="../../images/github-logo-white.png" alt="GitHub" class="github-logo">
                </a>
        </nav>
        
    </div>

    
    <div id="content-wrapper" class="single-page">
        <main>
            <article>
                <h1 class="h1-special center-text">Pentesting with Selenium WebDriver</h1>
                <p class="center-text">November 27, 2024</p>
                <div class="divider" style="margin: 5%"></div>
                <div class="post-body">
                    <h2 id="introduction">Introduction</h2>
<p>Selenium combined with chromium is a powerful tool for pentesting web applications. In this post, we will explore how to use Selenium WebDriver with a custom chromium instance to scrape data and execute desired actions. <strong>NOTE</strong>: This post is for educational purposes only. Always follow the terms of service. ðŸ˜‡</p>
<h2 id="background">Background</h2>
<p>For this post, we will be looking at some code I wrote for pentesting dingdingding.com, a social casino website that offers a daily bonus to its users. The code authenticates in to the website, collects the daily bonus, and provides a countdown for the next. The full code is available <a href="https://github.com/DrakeHooks/CasinoClaim/blob/main/dingdingdingAPI.py">here</a>.</p>
<h2 id="authentication">Authentication</h2>
<p>This is the first step to access the website and complete actions. This is also the most challenging step, as we have to get past a 2Captcha challenge. The code below uses selenium for clicking the elements and sending the credentials needed to authenticate. You may be wondering why there is an 80 second asyncio.sleep statement at the beginning. This is because the we need our chrome extension to solve the 2captcha. To load the extension into the browser, we copy the .crx to a temp directory in the Dockerfile.</p>
<div class="code-wrapper">
    <button class="copy-button">Copy</button>
    
    <div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="display:flex;"><span><span style="color:#f00">
</span></span></span><span style="display:flex;"><span><span style="color:#f00"></span><span style="color:#007f7f"># Copy the .crx file to a temporary directory</span><span style="color:#f00">
</span></span></span><span style="display:flex;"><span><span style="color:#f00"></span><span style="color:#fff;font-weight:bold">COPY</span> ./CAPTCHA-Solver-auto-hCAPTCHA-reCAPTCHA-freely-Chrome-Web-Store.crx /temp/CAPTCHA-Solver-auto-hCAPTCHA-reCAPTCHA-freely-Chrome-Web-Store.crx<span style="color:#f00">
</span></span></span></code></pre></div>
  </div>
  
  
<p>This chrome extension uses &ldquo;AI&rdquo; to solve the captcha. I am fully aware that there are alternatives to solving 2captcha, but they rely on manual human labor at rates that are
exploitative.</p>
<div class="code-wrapper">
    <button class="copy-button">Copy</button>
    
    <div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Function to authenticate into DingDingDing</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">async</span> <span style="color:#fff;font-weight:bold">def</span> authenticate_dingdingding(driver, bot, ctx):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">global</span> authenticated
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        web = <span style="color:#0ff;font-weight:bold">&#34;https://www.dingdingding.com/login&#34;</span>
</span></span><span style="display:flex;"><span>        driver.get(web)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> asyncio.sleep(<span style="color:#ff0;font-weight:bold">80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Wait for email and password fields, enter credentials from environment variables</span>
</span></span><span style="display:flex;"><span>        email_field = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">30</span>).until(
</span></span><span style="display:flex;"><span>            EC.presence_of_element_located((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div/div[1]/div[1]/div/div/div[2]/form/input[1]&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        email_field.send_keys(os.getenv(<span style="color:#0ff;font-weight:bold">&#34;DINGDINGDING&#34;</span>).split(<span style="color:#0ff;font-weight:bold">&#34;:&#34;</span>)[<span style="color:#ff0;font-weight:bold">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        password_field = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">30</span>).until(
</span></span><span style="display:flex;"><span>            EC.presence_of_element_located((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div/div[1]/div[1]/div/div/div[2]/form/input[2]&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        password_field.send_keys(os.getenv(<span style="color:#0ff;font-weight:bold">&#34;DINGDINGDING&#34;</span>).split(<span style="color:#0ff;font-weight:bold">&#34;:&#34;</span>)[<span style="color:#ff0;font-weight:bold">1</span>])
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> asyncio.sleep(<span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Click login button</span>
</span></span><span style="display:flex;"><span>            login_btn = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.element_to_be_clickable((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div/div[1]/div[1]/div/div/div[2]/form/button[2]&#34;</span>))
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>            login_btn.click()
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;Unable to solve captcha. Try again later.&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> asyncio.sleep(<span style="color:#ff0;font-weight:bold">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Check if login was successful</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> driver.current_url == <span style="color:#0ff;font-weight:bold">&#34;https://dingdingding.com/lobby/&#34;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;Authenticated into DingDingDing successfully!&#34;</span>)
</span></span><span style="display:flex;"><span>            authenticated = <span style="color:#fff;font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;Authentication failed. Did not reach the lobby.&#34;</span>)
</span></span><span style="display:flex;"><span>            authenticated = <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">except</span> TimeoutException:
</span></span><span style="display:flex;"><span>        authenticated = <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;Authentication timeout. Please check your credentials or XPaths.&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">True</span>
</span></span></code></pre></div>
  </div>
  
  
<p>We know our authentication was successful if we are redirected to the lobby. If we are not redirected, we will send a message to the user that the authentication failed. The way that this is implemented is by checking the current URL of the driver. If the current URL is the lobby, we know that we have successfully authenticated. The flag <code>authenticated</code> is set to true so when the bot is running by itself, it can check if it is authenticated to proceed.</p>
<h2 id="collecting-bonus-and-countdown">Collecting Bonus and Countdown</h2>
<p>To claim the bonus, we just use simple webdriver methods to find and click the buttons by CSS selectors and XPATHS. Using <code>await ctx.send()</code> is to send a message to discord. For the countdown timer, we use the .zfill method to format the time to be in the format HH:MM:SS.</p>
<p><div class="code-wrapper">
    <button class="copy-button">Copy</button>
    
    <div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Function to claim DingDingDing daily bonus</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">async</span> <span style="color:#fff;font-weight:bold">def</span> claim_dingdingding_bonus(driver, ctx):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Click the bonus button in the lobby</span>
</span></span><span style="display:flex;"><span>        bonus_button = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.element_to_be_clickable((By.CSS_SELECTOR, <span style="color:#0ff;font-weight:bold">&#34;#__nuxt &gt; div &gt; div:nth-child(1) &gt; aside.sidenav &gt; div.sidenav__cont &gt; div &gt; div.sidenav__actions &gt; button.btn.btn--nav.btn--rewards &gt; span.btn__label&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        bonus_button.click()
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;DingDingDing Daily Bonus Button Found!&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Click the collect button</span>
</span></span><span style="display:flex;"><span>        collect_button = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.element_to_be_clickable((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div[1]/div[6]/div/div[2]/div/div/button[2]&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        collect_button.click()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;DingDingDing Daily Bonus Claimed!&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">except</span> TimeoutException:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;COLLECT button not found! Check XPATH of claim button!&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Function to check the countdown for the next bonus</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">async</span> <span style="color:#fff;font-weight:bold">def</span> check_dingdingding_countdown(driver, ctx):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Retrieve countdown elements</span>
</span></span><span style="display:flex;"><span>        hours_element = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.presence_of_element_located((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div[1]/div[6]/div/div[2]/div/div/div/span/div[1]/span&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        minutes_element = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.presence_of_element_located((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div[1]/div[6]/div/div[2]/div/div/div/span/div[2]&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        seconds_element = WebDriverWait(driver, <span style="color:#ff0;font-weight:bold">10</span>).until(
</span></span><span style="display:flex;"><span>            EC.presence_of_element_located((By.XPATH, <span style="color:#0ff;font-weight:bold">&#34;/html/body/div[1]/div/div[1]/div[6]/div/div[2]/div/div/div/span/div[3]&#34;</span>))
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># Format countdown time</span>
</span></span><span style="display:flex;"><span>        countdown_message = <span style="color:#0ff;font-weight:bold">f</span><span style="color:#0ff;font-weight:bold">&#34;Next DingDingDing Bonus Available in: </span><span style="color:#0ff;font-weight:bold">{</span>hours_element.text.zfill(<span style="color:#ff0;font-weight:bold">2</span>)<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">:</span><span style="color:#0ff;font-weight:bold">{</span>minutes_element.text.zfill(<span style="color:#ff0;font-weight:bold">2</span>)<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">:</span><span style="color:#0ff;font-weight:bold">{</span>seconds_element.text.zfill(<span style="color:#ff0;font-weight:bold">2</span>)<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> ctx.send(countdown_message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">except</span> TimeoutException:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">await</span> ctx.send(<span style="color:#0ff;font-weight:bold">&#34;Failed to retrieve DingDingDing countdown timer.&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">True</span>
</span></span></code></pre></div>
  </div>
  
  
<img src="../../photos/blogimages/dingdingding.png" alt="discord bot"></p>
<h2 id="conclusion">Conclusion</h2>
<p>That&rsquo;s it! We have successfully authenticated into DingDingDing, claimed the daily bonus, and checked the countdown for the next bonus. The image above is what it looks like when invoked with a command for the discord bot. This is only a small example of what you can do with Selenium WebDriver combined with docker and chromium.</p>

                </div>
            </article>
        </main>
    </div>

    
    <div class="footer center-text">
        <p class="footer-text">
            Â© 2025 Drake Hooks | Built with 
            <a href="https://gohugo.io" class="footer-text">Hugo</a>
        </p>
    </div>
<script src="../../js/copy-code.js"></script>

</body>
</html>

